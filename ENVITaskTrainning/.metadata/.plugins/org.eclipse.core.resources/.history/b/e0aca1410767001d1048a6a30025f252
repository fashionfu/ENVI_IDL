PRO test_VFC,                  $
  input_raster = input_raster, $ ;输入栅格
  minimum_ndvi = minimum_ndvi, $ ;最小NDVI，默认为0.05
  maximum_ndvi = maximum_ndvi, $ ;最大NDVI，默认为0.70
  output_uri   = output_uri      ;输出文件

  COMPILE_OPT idl2
  e = ENVI()

  ;计算NDVI
  ndvi_raster = ENVISpectralIndexRaster(input_raster, 'ndvi')

  ;转字符串
  mins = STRTRIM(minimum_ndvi, 2)
  maxs = STRTRIM(maximum_ndvi, 2)

  ;构建VFV计算公式
  vfc_exp = '(b1 gt '+maxs+')*1+(b1 lt '+mins+')*0+(b1 ge '+mins+$
    ' and b1 le '+maxs+')*(b1-'+mins+')/('+maxs+'-'+mins+')'

  ;波段运算，计算植被覆盖度
  task = ENVITask('PixelwiseBandMathRaster')
  Task.INPUT_RASTER = ndvi_raster
  Task.EXPRESSION = vfc_exp
  Task.DATA_IGNORE_VALUE = -999
  Task.OUTPUT_RASTER_URI = output_uri
  Task.Execute
END

